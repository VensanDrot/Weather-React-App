import { DateTime } from 'luxon';
const url = 'https://api.openweathermap.org/data/2.5/forecast?lat=41&lon=69&appid=63af4b12863f964b7dd0c84b2c1ef94a&units=metric&cnt=5';

const weatherApi = () => {

    return fetch(url)
        .then((res) => res.json())

}

const FTLT = (secs, zone, form = "cccc, dd LLL yyyy' | Local time: 'hh:mm a") => DateTime.fromSeconds(secs).setZone(zone).toFormat(form);


const formatweather = (data) => {
    let { timezone, hourly } = data;

    hourly = hourly.map((d) => {
        return {
            title: FTLT(d.dt, timezone, "hh:mm a"),
            temp: d.temp,
            icon: d.weather[0].icon,
        };
    });
    return { timezone, hourly };
}


const getFromatedWeather = async() => {
    const fweather = await weatherApi()
        .then(formatweather);
    return fweather;
}

export default getFromatedWeather;